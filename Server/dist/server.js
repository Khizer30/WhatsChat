"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const express_1=__importDefault(require("express")),cors_1=__importDefault(require("cors")),socket_io_1=require("socket.io"),http_1=require("http"),library_1=require("./library"),dotenv=__importStar(require("dotenv"));dotenv.config();const app=(0,express_1.default)(),port=8e3;app.use((0,cors_1.default)());const httpServer=(0,http_1.createServer)(app),io=new socket_io_1.Server(httpServer,{cors:{origin:process.env.ORIGIN}});io.on("connection",async e=>{e.on("start",async t=>{let r=await (0,library_1.readMessages)(t);e.broadcast.emit("updates",r)}),e.on("message",async t=>{let r=await (0,library_1.addMessage)(t);e.broadcast.emit("updates",r)})}),httpServer.listen(8e3,()=>{console.log("Server Started on Port 8000")});